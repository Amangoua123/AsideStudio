---
import { Image } from "astro:assets";
import logoBL from "../assets/logo/asideBL.svg";
import logoWH from "../assets/logo/asideWH.svg";

// MAIN MENU

const menu = [
  { label: "About", href: "/about" },
  { label: "Portfolio", href: "/portfolio" },
  { label: "Archives", href: "/blog" },
  { label: "Services", href: "/services" },
  { label: "Contact", href: "/contact" },
];

// SECOND MENU

const menu2 = [
  { label: "Terms et usages", href: "/about" },
  { label: "Data & Policy", href: "/portfolio" },
  { label: "Accessibility", href: "/portfolio" },
];
---

<header
  id="site-header"
  class="fixed top-0 left-0 w-full z-50 transition-all duration-300"
>
  <nav
    class="fixed z-2 mx-auto max-w-8xl px-6 py-4 grid grid-cols-12 items-center justify-between"
  >
    <!-- Social icons -->

    <div class="flex space-x-4 col-span-2">
      <a
        href="https://github.com/yourname"
        aria-label="GitHub"
        class="text-white hover:opacity-70 transition"
      >
        <svg
          class="w-6 h-6 dark:text-white"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          fill="none"
          viewBox="0 0 24 24"
        >
          <path
            fill="currentColor"
            fill-rule="evenodd"
            d="M3 8a5 5 0 0 1 5-5h8a5 5 0 0 1 5 5v8a5 5 0 0 1-5 5H8a5 5 0 0 1-5-5V8Zm5-3a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3V8a3 3 0 0 0-3-3H8Zm7.597 2.214a1 1 0 0 1 1-1h.01a1 1 0 1 1 0 2h-.01a1 1 0 0 1-1-1ZM12 9a3 3 0 1 0 0 6 3 3 0 0 0 0-6Zm-5 3a5 5 0 1 1 10 0 5 5 0 0 1-10 0Z"
            clip-rule="evenodd"></path>
        </svg>
      </a>

      <a
        href="https://github.com/yourname"
        aria-label="GitHub"
        class="text-white hover:opacity-70 transition"
      >
        <svg
          class="w-6 h-6 dark:text-white"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          fill="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            fill-rule="evenodd"
            d="M12.51 8.796v1.697a3.738 3.738 0 0 1 3.288-1.684c3.455 0 4.202 2.16 4.202 4.97V19.5h-3.2v-5.072c0-1.21-.244-2.766-2.128-2.766-1.827 0-2.139 1.317-2.139 2.676V19.5h-3.19V8.796h3.168ZM7.2 6.106a1.61 1.61 0 0 1-.988 1.483 1.595 1.595 0 0 1-1.743-.348A1.607 1.607 0 0 1 5.6 4.5a1.601 1.601 0 0 1 1.6 1.606Z"
            clip-rule="evenodd"></path>
          <path d="M7.2 8.809H4V19.5h3.2V8.809Z"></path>
        </svg>
      </a>
    </div>

    <!-- Logo -->
    <div class="col-span-8 z-50">
      <a href="/">
        <Image class="h-10" src={logoWH} alt="Logo" />
      </a>
    </div>

    <div class="nav-toggle col-span-2 flex justify-end">
      <div
        class="nav-toggle-btn z-5 w-12 h-12 p-2 flex flex-col justify-center rounded-full cursor-pointer border-white border gap-2"
      >
        <span class="bar-1 w-full h-px will-change-transform bg-white"></span>
        <span class="bar-2 w-full h-px will-change-transform bg-white"></span>
      </div>
    </div>

    <!-- Menu -->
    <div
      class="menu invisible fixed top-0 left-0 w-full h-svh pointer-none overflow-hidden z-1"
    >
      <div class="menu-bg absolute w-full h-full">
        <div class="menu-bg-left left-0 absolute w-1/2 h-full overflow-hidden">
          <div
            class="menu-bg-left-inner bg-black origin-[100%_50%] -rotate-180 scale-[2] absolute w-full h-full will-change-transform"
          >
          </div>
        </div>
        <div
          class="menu-bg-right right-0 absolute w-1/2 h-full overflow-hidden"
        >
          <div
            class="menu-bg-right-inner bg-blue-500 origin-[0%_50%] rotate-180 scale-[2] absolute w-full h-full will-change-transform"
          >
          </div>
        </div>
      </div>
      <div class="menu-items absolute w-full h-full flex">
        <div
          class="menu-items-col uppercase text-menu_1 leading-normal flex flex-1 justify-center items-start gap-4 flex-col p-8"
        >
          {
            menu.map((item) => (
              <div class="menu-link text-white">
                <a href={item.href}>{item.label}</a>
              </div>
            ))
          }
        </div>
        <div
          class="menu-items-col text-menu_2 leading-normal flex-1 flex flex-col justify-center items-start gap-2 p-8"
        >
          {
            menu2.map((menu) => (
              <div class="menu-link">
                <a href={menu.href}>{menu.label}</a>
              </div>
            ))
          }
        </div>
      </div>
    </div>
  </nav>
</header>

<script>
  import { gsap } from "gsap";
  import { CustomEase } from "gsap/CustomEase";
  import { SplitText } from "gsap/SplitText";

  document.addEventListener("DOMContentLoaded", function () {
    gsap.registerPlugin(SplitText, CustomEase);

    CustomEase.create("hop", "0.85, 0,0.15, 1");

    const select = (element: any) => document.querySelector(element);
    const selectAll = (element: any) => document.querySelectorAll(element);

    const menu = select(".menu");
    const menuToggle = select(".nav-toggle-btn");
    let isMenuOpen = false;

    // Split text

    SplitText.create(".menu a, .menu p", {
      type: "lines",
      mask: "lines",
      linesClass: "line",
    });

    const tl = gsap.timeline({ paused: true });
    gsap.set(".menu", { autoAlpha: 1 });

    menuToggle.addEventListener("click", function (e) {
      if (isMenuOpen) {
        tl.reverse();
        menu.classList.remove("active");
      } else {
        tl.play();
        menu.classList.add("active");
      }
      isMenuOpen = !isMenuOpen;
    });

    tl.to(".nav-toggle-btn .bar-1", {
      y: 3.25,
      rotation: 45,
      scaleX: 0.75,
      duration: 1,
      ease: "hop",
    })
      .to(
        ".nav-toggle-btn .bar-2",
        {
          y: -3.25,
          rotation: -45,
          scaleX: 0.75,
          duration: 1,
          ease: "hop",
        },
        0,
      )
      .to(
        ".menu .menu-bg-left-inner",
        {
          rotate: 0,
          duration: 1,
          ease: "hop",
        },
        0,
      )
      .to(
        ".menu .menu-bg-right-inner",
        {
          rotate: 0,
          duration: 1,
          ease: "hop",
        },
        0,
      )
      .to(
        ".menu-items-col:nth-child(1) .line",
        {
          y: 0,
          duration: 0.75,
          ease: "power3.out",
          stagger: 0.1,
        },
        0.6,
      )
      .to(
        ".menu-items-col:nth-child(2) .line",
        {
          y: 0,
          duration: 0.75,
          ease: "power3.out",
          stagger: 0.1,
        },
        "<",
      );
  });
</script>
